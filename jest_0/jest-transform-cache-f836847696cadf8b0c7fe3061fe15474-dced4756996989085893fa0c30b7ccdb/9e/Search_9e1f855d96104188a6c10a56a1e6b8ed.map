{"version":3,"sources":["Search.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;AAyBA;;;;AACA;;;;AA1BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAMA;AAAA;AACA;AACA;AACA;AACA;AAJA;AAAA;;AAOA;;AAKA;AAAA;;AACA;;AAEA;AACA;;AAEA;AAAA;AAAA;;AAEA;AACA;;;AAEA;AACA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;;AAFA;AAAA;AAAA;;AAAA;AAKA;;AACA;AANA;AAAA;;AAAA;AAAA;AAAA;AAOA;;AAPA;AAAA;AAAA;AAAA;;AAAA;AAUA;;AACA;AAXA;AAAA;;AAAA;AAAA;AAAA;AAYA;;AAZA;AAAA;AAAA;AAAA;;AAAA;AAeA;;AACA;AAhBA;AAAA;;AAAA;AAAA;AAAA;AAiBA;;AAjBA;AAAA;AAAA;AAAA;;AAAA;AAoBA;;AACA;AArBA;AAAA;;AAAA;AAAA;AAAA;AAsBA;;AAtBA;AAAA;AAAA;AAAA;;AAAA;AAyBA;;AACA;AA1BA;AAAA;;AAAA;AAAA;AAAA;AA2BA;;AA3BA;AA6BA;;AACA;AACA;AACA;AACA;AACA;;AAlCA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAmCA;AAEA;AAAA;;AACA;AACA;AACA;;AAEA;AACA;AACA;AAAA;AACA;AACA;AAAA;AAAA;AACA;AACA;AAEA;AACA;AAGA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAxEA;AAxBA","sourcesContent":["<template>\n  <div class=\"w-full flex items-center px-5 sm:px-10\">\n    <button @click=\"$store.dispatch('ui/setHeaderType', null)\">\n      <img src=\"@/assets/images/icons/cross.svg\" />\n    </button>\n\n    <label for=\"search\" class=\"hidden\">{{ $t(\"Search\") }}</label>\n\n    <input\n      type=\"search\"\n      ref=\"search\"\n      :placeholder=placeholder\n      class=\"search-input w-full flex-auto mr-2 py-4 pl-4 bg-transparent\"\n      :class=\"{ 'text-grey': nightMode }\"\n      v-model=\"query\"\n      v-tooltip=\"{show: nothingFound, content: $t('Nothing matched your search'), trigger: 'manual', placement: 'bottom-start', classes: 'search-tip' }\"\n      @keyup.enter=\"search\" />\n\n    <div class=\"search-icon text-grey hover:text-blue p-3 md:p-4\" @click=\"search\">\n      <svg class=\"fill-current\" width=\"20\" height=\"20\" viewBox=\"0 0 1792 1792\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M1216 832q0-185-131.5-316.5t-316.5-131.5-316.5 131.5-131.5 316.5 131.5 316.5 316.5 131.5 316.5-131.5 131.5-316.5zm512 832q0 52-38 90t-90 38q-54 0-90-38l-343-342q-179 124-399 124-143 0-273.5-55.5t-225-150-150-225-55.5-273.5 55.5-273.5 150-225 225-150 273.5-55.5 273.5 55.5 225 150 150 225 55.5 273.5q0 220-124 399l343 343q37 37 37 90z\"/></svg>\n    </div>\n  </div>\n</template>\n\n<script type=\"text/ecmascript-6\">\nimport SearchService from '@/services/search'\nimport { mapGetters } from 'vuex'\n\nexport default {\n  data: () => ({\n    query: null,\n    nothingFound: false,\n    searchCount: 0,\n    placeholder: 'Search'\n  }),\n\n  computed: {\n    ...mapGetters('ui', ['nightMode']),\n    ...mapGetters('network', ['knownWallets'])\n  },\n\n  mounted() {\n    this.$refs.search.focus()\n\n    const WIDTH_THRESHOLD = 1024\n    const widthQuery = window.matchMedia(`(max-width: ${WIDTH_THRESHOLD}px)`)\n\n    widthQuery.addListener(e => this.setMobilePlaceholder(e.matches))\n\n    this.setMobilePlaceholder(window.innerWidth < WIDTH_THRESHOLD)\n  },\n\n  methods: {\n    async search() {\n      this.nothingFound = false\n      this.searchCount = 0\n\n      try {\n        const responseAddress = await SearchService.findByAddress(this.query)\n        this.changePage('wallet', { address: responseAddress.account.address })\n      } catch(e) { this.updateSearchCount(e) }\n\n      try {\n        const responseUsername = await SearchService.findByUsername(this.query)\n        this.changePage('wallet', { address: responseUsername.delegate.address })\n      } catch(e) { this.updateSearchCount(e) }\n\n      try {\n        const responsePublicKey = await SearchService.findByPublicKey(this.query)\n        this.changePage('wallet', { address: responsePublicKey.delegate.address })\n      } catch(e) { this.updateSearchCount(e) }\n\n      try {\n        const responseBlock = await SearchService.findByBlockId(this.query)\n        this.changePage('block', { id: responseBlock.block.id })\n      } catch(e) { this.updateSearchCount(e) }\n\n      try {\n        const responseTransaction = await SearchService.findByTransactionId(this.query)\n        this.changePage('transaction', { id: responseTransaction.transaction.id })\n      } catch(e) { this.updateSearchCount(e) }\n\n      const address = this.findByNameInKnownWallets(this.query)\n      if (address) {\n        this.changePage('wallet', { address: address })\n      } else {\n        this.updateSearchCount(null)\n      }\n    },\n\n    updateSearchCount(err) {\n      if (err !== null) {\n        console.log(err.message || err.data.error)\n      }\n\n      // Increment counter to keep track of whether we found anything\n      this.searchCount += 1\n      if (this.searchCount === 6) { // Should match total amount of callbacks\n        this.nothingFound = true\n        setTimeout(() => (this.nothingFound = false), 1500)\n      }\n    },\n\n    setMobilePlaceholder(showMobile) {\n      this.placeholder = showMobile\n        ? this.$i18n.t('Search')\n        : this.$i18n.t('Find a block, transaction, address or delegate')\n    },\n\n    changePage(name, params) {\n      this.$router.push({ name, params })\n      this.$store.dispatch('ui/setHeaderType', null)\n    },\n\n    findByNameInKnownWallets(name) {\n      if (name !== null) {\n        for (const address in this.knownWallets) {\n          if (this.knownWallets.hasOwnProperty(address)) {\n            if (this.query.toLowerCase() === this.knownWallets[address].toLowerCase()) {\n              return address\n            }\n          }\n        }\n      }\n    },\n  },\n}\n</script>\n\n<style>\n.search-input::placeholder {\n  color: var(--color-theme-text-placeholder);\n}\n\n.search-icon:hover {\n  box-shadow: 0 0 13px 2px rgba(197, 197, 213, 0.24);\n  cursor: pointer;\n}\n\n.tooltip.search-tip .tooltip-inner {\n  background-color: #ef192d;\n  color: white;\n}\n\n.tooltip.search-tip .tooltip-arrow {\n  border-color: #ef192d;\n}\n</style>\n"]}